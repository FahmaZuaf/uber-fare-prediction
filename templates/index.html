<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Uber Fare Prediction</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
    <meta name="theme-color" content="#3a86ff" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet" />
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

    <style>
      :root {
        --primary-color: #3a86ff;
        --secondary-color: #8338ec;
        --accent-color: #ff006e;
        --light-color: #f8f9fa;
        --dark-color: #212529;
        --error-color: #ff4d4d;
      }

      * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
      }

      body {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        font-family: "Poppins", sans-serif;
        min-height: 100vh;
        padding: 15px;
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
      }

      .card {
        margin: 20px auto;
        padding: 25px;
        border-radius: 16px;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        border: none;
        background: rgba(255, 255, 255, 0.98);
        max-width: 100%;
        width: 100%;
        transition: all 0.3s ease;
      }

      @media (min-width: 768px) {
        .card {
          padding: 35px;
          border-radius: 20px;
          margin-top: 40px;
          max-width: 600px;
        }
      }

      h3 {
        color: var(--primary-color);
        font-weight: 600;
        margin-bottom: 25px;
        position: relative;
        padding-bottom: 12px;
        font-size: 1.5rem;
      }

      h3:after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 3px;
        background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        border-radius: 3px;
      }

      .form-label {
        font-weight: 500;
        color: var(--dark-color);
        margin-bottom: 6px;
        font-size: 0.95rem;
      }

      .form-control {
        border-radius: 10px;
        padding: 12px 15px;
        border: 2px solid #e9ecef;
        transition: all 0.3s;
        font-size: 1rem;
        height: auto;
      }

      .form-control:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 0.2rem rgba(58, 134, 255, 0.2);
      }

      .form-control.invalid {
        border-color: var(--error-color);
        background-color: rgba(255, 77, 77, 0.05);
      }

      .error-message {
        color: var(--error-color);
        font-size: 0.8rem;
        margin-top: 4px;
        display: none;
      }

      .btn-primary {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        border: none;
        border-radius: 10px;
        padding: 14px;
        font-weight: 500;
        letter-spacing: 0.5px;
        transition: all 0.3s;
        text-transform: uppercase;
        font-size: 1rem;
        width: 100%;
      }

      .btn-primary:hover,
      .btn-primary:focus {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(58, 134, 255, 0.4);
      }

      .btn-primary:active {
        transform: translateY(0);
      }

      .btn-primary:disabled {
        background: #cccccc;
        transform: none;
        box-shadow: none;
        cursor: not-allowed;
      }

      .alert {
        border-radius: 10px;
        border: none;
        font-weight: 500;
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        color: white;
        box-shadow: 0 4px 12px rgba(0, 242, 254, 0.25);
        padding: 12px;
        font-size: 0.95rem;
        margin-top: 20px;
      }

      /* Input number styling */
      input[type="number"] {
        -moz-appearance: textfield; /* Firefox */
        appearance: textfield; /* Standard */
      }

      input[type="number"]::-webkit-inner-spin-button,
      input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }

      /* Floating animation */
      @keyframes floating {
        0% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-8px);
        }
        100% {
          transform: translateY(0px);
        }
      }

      .taxi-icon {
        font-size: 1.8rem;
        display: inline-block;
        animation: floating 3s ease-in-out infinite;
      }

      /* Mobile-specific adjustments */
      @media (max-width: 576px) {
        body {
          padding: 10px;
        }

        .card {
          padding: 20px 15px;
          margin: 10px auto;
        }

        h3 {
          font-size: 1.3rem;
          margin-bottom: 20px;
        }

        .form-control {
          padding: 10px 12px;
        }

        .btn-primary {
          padding: 12px;
          font-size: 0.95rem;
        }
      }

      /* Tablet adjustments */
      @media (min-width: 577px) and (max-width: 991px) {
        .card {
          max-width: 500px;
        }
      }

      /* Prevent zoom on input focus for mobile */
      @media screen and (max-width: 767px) {
        input,
        select,
        textarea {
          font-size: 16px !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="container-fluid px-0">
      <div class="row justify-content-center mx-0">
        <div class="col-12 col-sm-10 col-md-8 col-lg-6 px-0">
          <div class="card bg-white animate__animated animate__fadeIn">
            <h3 class="text-center mb-4"><span class="taxi-icon">ðŸš•</span> Uber Fare Predictor</h3>
            <form id="predictionForm" method="POST" action="/predict" novalidate>
              <div class="mb-3">
                <label class="form-label">Distance (km):</label>
                <input type="number" name="distance_km" step="0.1" min="0.1" class="form-control" placeholder="e.g. 5.2 km" required />
                <div class="error-message">Minimum 0.1 km required</div>
              </div>

              <div class="mb-3">
                <label class="form-label">Passenger Count:</label>
                <input type="number" name="passenger_count" min="1" max="8" class="form-control" placeholder="1-8 passengers" required />
                <div class="error-message">Between 1-8 passengers</div>
              </div>

              <div class="mb-3">
                <label class="form-label">Hour (0â€“23):</label>
                <input type="number" name="hour" min="0" max="23" class="form-control" placeholder="0 (midnight) to 23 (11 PM)" required />
                <div class="error-message">Enter hour (0-23)</div>
              </div>

              <div class="mb-3">
                <label class="form-label">Day of Week (0=Mon, 6=Sun):</label>
                <input type="number" name="day_of_week" min="0" max="6" class="form-control" placeholder="0 (Monday) to 6 (Sunday)" required />
                <div class="error-message">Enter day (0-6)</div>
              </div>

              <div class="mb-3">
                <label class="form-label">Month (1â€“12):</label>
                <input type="number" name="month" min="1" max="12" class="form-control" placeholder="1 (Jan) to 12 (Dec)" required />
                <div class="error-message">Enter month (1-12)</div>
              </div>

              <div class="d-grid mt-4">
                <button type="submit" class="btn btn-primary" id="submitBtn">Predict Fare</button>
              </div>
            </form>

            {% if prediction_text %}
            <div class="alert alert-success mt-4 text-center animate__animated animate__fadeInUp">
              <strong>{{ prediction_text }}</strong>
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Enhanced Mobile-Friendly Validation -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("predictionForm");
        const inputs = form.querySelectorAll('input[type="number"]');
        const submitBtn = document.getElementById("submitBtn");

        // Touch device detection
        const isTouchDevice = "ontouchstart" in window || navigator.maxTouchPoints > 0;

        // Real-time validation with debounce for performance
        let timeout;
        inputs.forEach((input) => {
          input.addEventListener("input", function () {
            clearTimeout(timeout);
            timeout = setTimeout(
              () => {
                validateInput(this);
                checkFormValidity();
              },
              isTouchDevice ? 300 : 100
            );
          });

          input.addEventListener("blur", function () {
            validateInput(this);
            checkFormValidity();
          });
        });

        function validateInput(input) {
          const errorMessage = input.nextElementSibling;
          const min = parseFloat(input.getAttribute("min")) || 0;
          const max = parseFloat(input.getAttribute("max")) || Infinity;
          const value = parseFloat(input.value) || 0;

          if (input.value.trim() === "" || isNaN(value)) {
            showError(input, errorMessage, "This field is required");
            return false;
          }

          if (value < min || value > max) {
            showError(input, errorMessage, `Value must be between ${min} and ${max}`);
            return false;
          }

          clearError(input, errorMessage);
          return true;
        }

        function showError(input, errorElement, message) {
          input.classList.add("invalid");
          errorElement.textContent = message;
          errorElement.style.display = "block";
        }

        function clearError(input, errorElement) {
          input.classList.remove("invalid");
          errorElement.style.display = "none";
        }

        function checkFormValidity() {
          let formIsValid = true;
          inputs.forEach((input) => {
            if (!validateInput(input)) {
              formIsValid = false;
            }
          });

          submitBtn.disabled = !formIsValid;
        }

        // Initial validation check
        checkFormValidity();

        // Form submission handling
        form.addEventListener("submit", function (e) {
          let formIsValid = true;
          inputs.forEach((input) => {
            if (!validateInput(input)) {
              formIsValid = false;
              // Scroll to first invalid input on mobile
              if (isTouchDevice && formIsValid) {
                input.scrollIntoView({ behavior: "smooth", block: "center" });
              }
            }
          });

          if (!formIsValid) {
            e.preventDefault();
            if (isTouchDevice) {
              const firstInvalid = form.querySelector(".invalid");
              if (firstInvalid) {
                firstInvalid.scrollIntoView({ behavior: "smooth", block: "center" });
              }
            }
          }
        });

        // Prevent form zoom on focus in mobile iOS
        if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
          inputs.forEach((input) => {
            input.addEventListener("focus", function () {
              window.scrollTo(0, 0);
              document.body.scrollTop = 0;
            });
          });
        }
      });
    </script>
  </body>
</html>
